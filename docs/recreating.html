

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Recreating the Model &mdash; Olfactory Bulb 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Running Simulations in the Cloud (AWS)" href="cloud.html" />
    <link rel="prev" title="Visualizing the Model" href="visualizing.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Olfactory Bulb
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualizing.html">Visualizing the Model</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Recreating the Model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#mitral-tufted-and-granule-cell-morphologies-cleaned-morphology-metrics-computed-and-representative-morphologies-chosen">Mitral, tufted, and granule cell morphologies cleaned, morphology metrics computed, and representative morphologies chosen</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cell-electrical-properties-and-behavior-identified-and-characterized">Cell electrical properties and behavior identified and characterized</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ion-channels-placed-onto-chosen-cell-morphologies-and-conductances-fitted-to-experimental-distributions">Ion channels placed onto chosen cell morphologies and conductances fitted to experimental distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#olfactory-bulb-layers-were-reconstructed-from-sagittal-and-coronal-slices">Olfactory bulb layers were reconstructed from sagittal and coronal slices</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fitted-cell-somas-were-placed-within-each-cell-type-s-stereotypical-laminar-location">Fitted cell somas were placed within each cell type’s stereotypical laminar location</a></li>
<li class="toctree-l2"><a class="reference internal" href="#apical-dendrites-were-rotated-towards-their-stereotypical-terminations">Apical dendrites were rotated towards their stereotypical terminations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mitral-and-tufted-cell-lateral-dendrites-were-aligned-with-the-curvature-of-reconstructed-olfactory-bulb-layers">Mitral and tufted cell lateral dendrites were aligned with the curvature of reconstructed olfactory bulb layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reciprocal-synapses-were-formed-based-on-dendritic-proximity-between-principal-and-granule-cell-dendrites">Reciprocal synapses were formed based on dendritic proximity between principal and granule cell dendrites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gap-junctions-were-formed-between-glomerular-sibling-principal-cell-tufted-dendrites">Gap junctions were formed between glomerular sibling principal cell tufted dendrites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#glomeruli-stimulated-during-odor-experiments-were-mapped-onto-the-model-glomeruli">Glomeruli stimulated during odor experiments were mapped onto the model glomeruli</a></li>
<li class="toctree-l2"><a class="reference internal" href="#a-model-of-glomerular-input-spikes-was-created-to-stimulate-the-model">A model of glomerular input spikes was created to stimulate the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#an-extracellular-local-field-potential-electrode-was-placed-into-the-granule-cell-layer">An extracellular local field potential electrode was placed into the granule cell layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#neuron-mpi-simulations-were-performed-and-lfp-signal-analyzed-using-wavelet-transform">NEURON+MPI simulations were performed and LFP signal analyzed using wavelet transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="#network-parameters-were-explored-until-the-two-cluster-gamma-fingerprint-was-reproduced">Network parameters were explored until the two-cluster gamma fingerprint was reproduced</a></li>
<li class="toctree-l2"><a class="reference internal" href="#computational-experiments-were-performed-to-demonstrate-the-mechanisms-underlying-the-gamma-fingerprint">Computational experiments were performed to demonstrate the mechanisms underlying the gamma fingerprint</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cloud.html">Running Simulations in the Cloud (AWS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="olfactorybulb.html">Model Python Class Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Olfactory Bulb</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Recreating the Model</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/recreating.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="recreating-the-model">
<h1>Recreating the Model<a class="headerlink" href="#recreating-the-model" title="Permalink to this headline">¶</a></h1>
<p>The model was created in stages: cell models, network models, odor input, LFP output, simulations, and experiments. While these stages are described in the <a class="reference external" href="https://repository.asu.edu/attachments/223567/content/Birgiolas_asu_0010E_19503.pdf">dissertation</a>, the sections below describe technical details and include links to specific files, tools, and resources. The sections are organized in a chronological order, which can be followed to re-create this or a similar model.</p>
<div class="section" id="mitral-tufted-and-granule-cell-morphologies-cleaned-morphology-metrics-computed-and-representative-morphologies-chosen">
<h2>Mitral, tufted, and granule cell morphologies cleaned, morphology metrics computed, and representative morphologies chosen<a class="headerlink" href="#mitral-tufted-and-granule-cell-morphologies-cleaned-morphology-metrics-computed-and-representative-morphologies-chosen" title="Permalink to this headline">¶</a></h2>
<p><strong>Morphology Archives</strong></p>
<p>Morphologies for each cell type (mitral, tufted, granule) were obtained from <a class="reference external" href="http://neuromorpho.org/">NeuroMorpho.org</a>, by performing a <a class="reference external" href="http://neuromorpho.org/MetaData.jsp">‘Metadata search’</a> of reconstruction archives. The archives were filtered to include cells with the following parameters: mouse, adult, olfactory bulb region, control condition, and mitral, tufted, or granule cell type.</p>
<p><strong>Inspection and Editing of the SWC Files</strong></p>
<p>Each resulting archive was downloaded and organized into folders which can be found under <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/tree/master/morphology-data">[repo]/morphology-data</a>. The 3D renderings of the .SWC files under each archive were manually examined using the <a class="reference external" href="https://www.neutracing.com/">neuTube</a> software. neuTube functions were used to fix simple and obvious flaws (e.g. parts of dendritic trees shifted laterally, or all sections mislabeled as ‘basal’ dendrites). Archives with cells missing important stereotypical features of each cell type were excluded. Besides, neuTube, other <a class="reference external" href="https://neurojustas.com/2019/03/10/tools-for-editing-swc-files-neuron-morphology/">neuronal morphology/SWC editing software</a> was evaluated, but ultimately not used.</p>
<p>Each SWC archive was labeled for whether it was a ‘thin’ (parts of lateral dendrites missing) or ‘full’ (the whole cell was reconstructed) slice. Whether the cells included a soma reconstruction, and whether the reconstructed dendrites included width/radius information (e.g. some archives used constant radius).</p>
<p>The fixed SWC files were saved back into the archive folders and archive categorizations were stored in the <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/blob/master/notebooks/morphology.ipynb">[repo]/notebooks/morphology.ipynb Jupyter Notebook</a>.</p>
<p><strong>Computing Reconstructed Cell Population Morphology Metrics</strong></p>
<p>For each reconstruction, NeuroMorpho.org displays a set of whole-cell morphology metrics (e.g. see ‘Measurements’ section of <a class="reference external" href="http://neuromorpho.org/neuron_info.jsp?neuron_name=1-09-TD2b">this reconstruction</a>). For cells in this model, those metrics were computed for soma, apical dendrites, and lateral dendrites of each reconstruction.</p>
<p>The metrics were computed using the <a class="reference external" href="https://github.com/justasb/pylmeasure">pyLMeasure tool</a> (which is a Python wrapper of the <a class="reference external" href="http://cng.gmu.edu:8080/Lm/">L-Measure</a> tool). Each metric was formalized as tests of the <a class="reference external" href="https://github.com/scidash/neuronunit">NeuronUnit framework</a>. The test definitions have been incorporated into NeuronUnit and can be found under <a class="reference external" href="https://github.com/scidash/neuronunit/blob/dev/neuronunit/tests/morphology.py">[neuronunit]/tests/morphology.py</a></p>
<p>The morphology metrics of each cell were computed using suites of NeuronUnit tests (see: <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/blob/master/notebooks/morphology.ipynb">[repo]/notebooks/morphology.ipynb</a>) and results stored in <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/blob/master/olfactorybulb/model-data.sqlite">the model’s SQLite Database</a> in the <code class="docutils literal notranslate"><span class="pre">measurement</span></code> table. The database tables and records can be viewed online with tools like <a class="reference external" href="https://sqliteonline.com/">SQLite online</a> or offline with an SQLite editor like <a class="reference external" href="http://sqliteexpert.com/">SQLite Expert</a>.</p>
<p>The overall means and standard deviations of each morphology metric were stored in the database in the <code class="docutils literal notranslate"><span class="pre">property</span></code> table. These overall means and standard deviations were used to select five stereotypical morphologies of each cell type. Reconstructions whose morphology metrics were closest to the cell type population means were selected to be used for cell models in this model. They can be found under <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/tree/master/prev_ob_models/Birgiolas2020/SWCs">[repo]/prev_ob_models/Birgiolas2020/SWCs</a>.</p>
<p>The validation of the representativeness of the selected morphologies and comparison with previously published models can be found in the <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/blob/master/notebooks/morphology-validation.ipynb">morphology-validation.ipynb notebook</a></p>
<p><strong>Morphology Standardization to Prepare for Network Embedding</strong></p>
<p>To facilitate the embedding of the cell models within reconstructed network layers, the cell morphologies were further edited as follows. The cells were reoriented so that their apical dendrites were aligned with the Z-axis. The natural curvature of lateral dendrites of mitral and tufted cells was planarized so that the lateral dendrites were essentially perpendicular to the apical dendrites. This prepared the lateral dendrites for an algorithm to confine them to the appropriate cell-type-specific laminar regions in the network model. These standardized morphologies can be found under <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/tree/master/prev_ob_models/Birgiolas2020/morphology">[repo]/prev_ob_models/Birgiolas2020/morphology</a>.</p>
</div>
<div class="section" id="cell-electrical-properties-and-behavior-identified-and-characterized">
<h2>Cell electrical properties and behavior identified and characterized<a class="headerlink" href="#cell-electrical-properties-and-behavior-identified-and-characterized" title="Permalink to this headline">¶</a></h2>
<p>Once cell morphologies were selected, they were turned into active models by inserting ion channel mechanisms. To understand which ion channels should be included, a survey of electrical behaviors of each cell type was conducted via a literature search.</p>
<p><strong>Generic Test and Publication Python Classes</strong></p>
<p>Electrical properties of mitral, tufted, and granule cells from main olfactory bulbs of adult mice were aggregated from literature. These properties included passive (e.g. input resistance and resting voltage) and active membrane properties (e.g. spike half-width, spike accommodation, and inhibitory rebound). The protocols used to measure and compute each property were formalized using a set of NeuronUnit tests. Each publication used slightly different protocols and algorithms to compute the properties (e.g. different slice temperatures, different delays to measure input resistance, different ways to compute action potential threshold). To fairly evaluate how a model reproduces a property, these protocol differences were formalized into the NeuronUnit tests as well. A given property reported in a publication was formalized as a NeuronUnit test that consisted of 1) a generic electrophysiology property Python class (e.g. <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/blob/master/olfactorybulb/neuronunit/tests/tests.py#L53">RestingVoltageTest</a>) and 2) publication-specific modifications of the property measurement protocol (e.g. <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/blob/master/olfactorybulb/neuronunit/tests/publications.py#L34">BurtonUrban2014</a>).</p>
<p>A NeuronUnit test that computes a property using protocol variations from a specific publication is declared by combining the generic test class with a publication class using Python’s multiple inheritance (e.g. <code class="docutils literal notranslate"><span class="pre">class</span> <span class="pre">InputResistanceUrbanBurton2014Test(UrbanBurton2014,</span> <span class="pre">InputResistanceTest)</span></code> ). Due to the large number of property and publication combinations, these combined classes were created at run time using <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/blob/master/olfactorybulb/neuronunit/tests/__init__.py#L73">a helper method</a>.</p>
<p>The measurements from each publication are recorded in the SQLite database, <code class="docutils literal notranslate"><span class="pre">measurement</span></code> table. The NeuronUnit class to use for each measurement is defined in the <code class="docutils literal notranslate"><span class="pre">property</span></code> table and <code class="docutils literal notranslate"><span class="pre">test_class_generic</span></code> column. At run-time, the helper method combined the generic test class with the publication class to create a class that computed the property using the protocol parameters specified in each publication.</p>
</div>
<div class="section" id="ion-channels-placed-onto-chosen-cell-morphologies-and-conductances-fitted-to-experimental-distributions">
<h2>Ion channels placed onto chosen cell morphologies and conductances fitted to experimental distributions<a class="headerlink" href="#ion-channels-placed-onto-chosen-cell-morphologies-and-conductances-fitted-to-experimental-distributions" title="Permalink to this headline">¶</a></h2>
<p><strong>Previously Published Olfactory Models</strong></p>
<p>A literature search to identify each cell type’s electrical properties revealed a set of ion channels likely responsible for the behavior. Furthermore, a separate literature search was performed to identify previous computational models of each cell type. <a class="reference external" href="https://senselab.med.yale.edu/ModelDB/default">ModelDB</a> was utilized to locate runnable NEURON simulator models. Results from the initial search of all olfactory bulb or cell models were manually inspected by following the instructions to run the models and then inspecting which cell types were modeled. If a model included multi-compartment morphologies, the morphology was extracted into .SWC files using the <a class="reference external" href="https://github.com/JustasB/hoc2swc">hoc2swc</a> tool. The set of previous olfactory models can be found under <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/tree/master/prev_ob_models">[repo]/prev_ob_models</a>.</p>
<p><strong>Selection of Ion Channel Models</strong></p>
<p>In addition to morphologies, the previous models included ion channel .MOD files. Many of the .MOD files were nearly identical copies of files from earlier publications. After tracing the publication geneology of each .MOD file, the most recent versions were identified. By examining the reasons why the channels were included, and comparing the electrical behavior seen in experimental literature, channels hypothesized to be responsible for the experimentally observed behaviors were selected for inclusion in this model. If an ion channel model did not include temperature sensitivity, equations to utilize the Q10 coefficient were added to the .MOD file. The ion channel models used in this model can be found under <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/tree/master/prev_ob_models/Birgiolas2020/Mechanisms">[repo]/prev_ob_models/Birgiolas2020/Mechanisms</a>.</p>
<p>NEURON Cell Builder feature was used to import morphology SWC files and then insert channel mechanisms. The initial, unoptimized cell models can be found under <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/tree/master/prev_ob_models/Birgiolas2020/Cells">[repo]/prev_ob_models/Birgiolas2020/Cells</a>.</p>
<p><strong>Parameter Fitting and Validation</strong></p>
<p>A genetic optimization algorithm was used to identify the combinations of ion channel parameters that best reproduced experimentally observed electrical behaviors (minimized the error between model electrical property values and experimentally observed property means). The algorithm is defined in <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/blob/master/prev_ob_models/Birgiolas2020/fitting.py">fitting.py</a> and Jupyter notebooks used for fitting can be found under <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/tree/master/notebooks">[repo]/notebooks</a> (files that start with <code class="docutils literal notranslate"><span class="pre">fitting</span></code>).</p>
<p>The validation of the cell models against experimental data and comparison to previously published models can be found in <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/blob/master/notebooks/all-model-validation-results.ipynb">all-model-validation-results.ipynb notebook</a>.</p>
<p>The final, optimized models and their parameters are defined in <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/blob/master/prev_ob_models/Birgiolas2020/isolated_cells.py">[repo]/prev_ob_models/Birgiolas2020/isolated_cells.py</a> (see MC1..5, GC1..5, TC1..5 classes).</p>
<div class="sketchfab-embed-wrapper">
<iframe title="A 3D model" width="100%" height="480" src="https://sketchfab.com/models/21a500cd56d74fa2853b3d9e6b4c54b5/embed?preload=1&amp;ui_controls=1&amp;ui_infos=1&amp;ui_inspector=1&amp;ui_stop=1&amp;ui_watermark=1&amp;ui_watermark_link=1" frameborder="0" allow="autoplay; fullscreen; vr" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe></div></div>
<div class="section" id="olfactory-bulb-layers-were-reconstructed-from-sagittal-and-coronal-slices">
<h2>Olfactory bulb layers were reconstructed from sagittal and coronal slices<a class="headerlink" href="#olfactory-bulb-layers-were-reconstructed-from-sagittal-and-coronal-slices" title="Permalink to this headline">¶</a></h2>
<p><strong>Bulb Slices and Limitations</strong></p>
<p>To place olfactory bulb cell models in their appropriate anatomical locations, a reconstruction of olfactory bulb layers was necessary.
<a class="reference external" href="https://atlas.brain-map.org/atlas?atlas=1#atlas=1&amp;structure=507&amp;resolution=16.75&amp;x=5536&amp;y=4142&amp;zoom=-4&amp;plate=100960516&amp;z=5">Allen Brain Atlas</a> contains labeled sagital and coronal slices of full adult mouse olfactory bulbs. However, the Allen Atlas API, exposed only partialy reconstructed bulbs (frontal extremes were missing), and did not have labeled cell layer information. But, images of the full bulb slices with layers labeld were available through the <a class="reference external" href="https://atlas.brain-map.org/atlas?atlas=1#atlas=1&amp;structure=507&amp;resolution=16.75&amp;x=5536&amp;y=4142&amp;zoom=-4&amp;plate=100960516&amp;z=5">online viewer</a>. Furthermore, the sagital and coronal slices were different thickness, and the thiner coronal slices did not contain the the frontal bulb extreme region. Thus the coronal slice images were used to reconstruct the 3D shape of the mid and posterior parts of the olfactory bulb at higher resolution, and the thicker sagital slices were used to reconstruct the frontal extreme region.</p>
<p><strong>Conversion of 2D Slices to 3D Layer Meshes</strong></p>
<p>The slice images were downloaded and converted into SVG vector format using <a class="reference external" href="https://inkscape.org/">Inkscape</a>. The SVG files were imported into <a class="reference external" href="http://blender.org/">Blender</a> and positioned apart to match the thickness of the slices. The corresponding points of each neighboring layer were joined together using Blender’s <a class="reference external" href="https://docs.blender.org/manual/en/latest/modeling/meshes/editing/vertex/make_face_edge.html">Make Face (from edges)</a>. This process was repeated for each layer separately, until the 3D mesh of all the layers of the bulb were reconstructed. The number of polygons of the final mesh were reduced by using Blender’s <a class="reference external" href="https://docs.blender.org/manual/en/latest/modeling/modifiers/generate/decimate.html">Decimate Modifier</a> and the <a class="reference external" href="https://www.blendernation.com/2018/11/14/blender-2-8-feature-simplify-sculpting-brush/">Dyntopo (dynamic topology) sculpting tool</a>.</p>
<p>The Blender file containing the reconstructed layers can be found under <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/tree/master/blender-files">[repo]/blender-files</a> (bulb-layers.blend and ob-gloms-fast.blend).</p>
<div class="sketchfab-embed-wrapper">
<iframe title="A 3D model" width="100%" height="480" src="https://sketchfab.com/models/977a977c4eb9432d802a99dc760997c7/embed?preload=1&amp;ui_controls=1&amp;ui_infos=1&amp;ui_inspector=1&amp;ui_stop=1&amp;ui_watermark=1&amp;ui_watermark_link=1" frameborder="0" allow="autoplay; fullscreen; vr" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe></div><p><strong>Virtual Slices and Generating Potential Positions for Cell Somas within each Layer</strong></p>
<p>To generate positions within each layer where cell somas could be located, the reconstructed layers were filled with approximately evenly distributed points. This was done to enable the use of ‘virtual slices’. A virtual slice can be any 3D shape, but in this model, it was chosen to be a rectangular box. To construct a virtual slice, the slice shape is positioned over a desired part of the reconstructed layers. Any potential-soma points that are located within the parts of the layers that are contained within the virtual slice are selected to be used as potential cell placement locations. Points outside the virtual slice are ignored.</p>
<p>The points for possible cell locations can be found in <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/blob/master/blender-files/ob-gloms-fast.blend">ob-gloms-fast.blend</a> as Blender’s Particle Systems of reconstructed layer objects ending with “Particles” (e.g. <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">GL</span> <span class="pre">Particles</span></code> for potential positions for glomeruli, and <code class="docutils literal notranslate"><span class="pre">4</span> <span class="pre">GRL</span> <span class="pre">Particles</span></code> for positions of cells within the granule cell layer). The number of points in each layer was based on the cell and glomeruli count estimates in adult mice bulbs. The points were created using the <a class="reference external" href="https://github.com/BorisTheBrave/blue-noise-particles">Blue Noise Particles</a> addon for Blender.</p>
</div>
<div class="section" id="fitted-cell-somas-were-placed-within-each-cell-type-s-stereotypical-laminar-location">
<h2>Fitted cell somas were placed within each cell type’s stereotypical laminar location<a class="headerlink" href="#fitted-cell-somas-were-placed-within-each-cell-type-s-stereotypical-laminar-location" title="Permalink to this headline">¶</a></h2>
<p>When constructing a network model, after a virtual slice was positioned over a desired area of the bulbar layers, the potential locations of somas and glomeruli that were contained by the virtual slice mesh were selected for use as soma/glomeruli center locations.</p>
<p>This is started by the <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/blob/master/build-slice.py">[repo]/buil-dslice.py</a> and most of the work is performed by the <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/blob/master/olfactorybulb/slicebuilder/blender.py">SliceBuilderBlender</a> class.</p>
<p>Depending on the number of cells of each type specified in <code class="docutils literal notranslate"><span class="pre">SliceBuilderBlender</span></code>, a random subset of the positions contained within the virtual slice are used to place cell somas/glomeruli.</p>
<p>Mitral cell somas are placed in locations contained within the mitral cell layer. Tufted cells are placed within the external plexiform layer, and granule cells are placed within the granule cell layer.</p>
<p>When a mitral cell position is chosen, the closest glomerulus location is used to determine the minimum length that a mitral cell’s apical dendrite must have to be placed at that position (to satisfy the condition that mitral cell apical dendrites must terminate within the glomerular layer). A model is chosen at random from this set of mitral cell models that meet the apical dendrite criteria. If no mitral cell has a long-enough apical dendrite, the mitral cell model with the longest apical dendrite is chosen. The above rules are also followed for tufted cells, whose somas are placed within the external plexiform layer.</p>
<p>Similarly, granule cell somas are placed at locations within the virtual slice, however, a specific model for each location is selected at random from a set of granule cell models that have apical dendrites that terminate within the external plexiform layer (reach beyond the closest point of the external plexiform but do not reach into the glomerular layer.</p>
</div>
<div class="section" id="apical-dendrites-were-rotated-towards-their-stereotypical-terminations">
<h2>Apical dendrites were rotated towards their stereotypical terminations<a class="headerlink" href="#apical-dendrites-were-rotated-towards-their-stereotypical-terminations" title="Permalink to this headline">¶</a></h2>
<p>Once their somas are placed, cells of all types are rotated so that their apical dendrites point towards glomeruli closest to them. The cells are then rotated around the apical dendrite axis by a random degree. At this point, mitral and tufted cell apical dendrites point towards the glomeruli that are closest to the cell somas, and due to the cell morphology standardization step described earlier, the lateral dendrites lie in a plane that is approximately orthogonal to the apical dendrites. However, the apical dendrites of the selected mitral or tufted cell model might extend beyond the closest glomerulus. For this reason, the apical dendrites are rotated independently from the soma, to point towards glomeruli that lie at approximately the same distance as the length of the apical dendrite. This guarantees that the mitral and tufted cell dendrites terminate within the glomerular layer.</p>
</div>
<div class="section" id="mitral-and-tufted-cell-lateral-dendrites-were-aligned-with-the-curvature-of-reconstructed-olfactory-bulb-layers">
<h2>Mitral and tufted cell lateral dendrites were aligned with the curvature of reconstructed olfactory bulb layers<a class="headerlink" href="#mitral-and-tufted-cell-lateral-dendrites-were-aligned-with-the-curvature-of-reconstructed-olfactory-bulb-layers" title="Permalink to this headline">¶</a></h2>
<p>In experimental literature, mitral and tufted cell lateral dendrites tend to be confined to the external plexiform layer, and generally follow the local curvature of the layer. To replicate this phenomenon, after mitral and tufted cells were placed, and apical dendrites oriented, the lateral dendrites of mitral and tufted cells were confined to the external plexiform layer. Mitral cell lateral dendrites were confined to the inner 60% portion of the external plexiform layer, while tufted cell lateral dendrites were confined to the remaining outer 40% portion.</p>
<p>The final cell positions and morphology were saved for later instantiation in NEURON. The morphology transform files can be found under <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/tree/master/olfactorybulb/slices/DorsalColumnSlice">[repo]/slices/DorsalColumnSlice ([X]C.json files)</a>.</p>
<div class="sketchfab-embed-wrapper">
<iframe title="A 3D model" width="100%" height="480" src="https://sketchfab.com/models/fffdafc7ef2f4e0ab7d006daf3517da7/embed?preload=1&amp;ui_controls=1&amp;ui_infos=1&amp;ui_inspector=1&amp;ui_stop=1&amp;ui_watermark=1&amp;ui_watermark_link=1" frameborder="0" allow="autoplay; fullscreen; vr" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe></div><p>In the above visualization of the virtual slice used in this model, mitral cells are yellow/green, tufted cells are red, and granule cells are blue.</p>
</div>
<div class="section" id="reciprocal-synapses-were-formed-based-on-dendritic-proximity-between-principal-and-granule-cell-dendrites">
<h2>Reciprocal synapses were formed based on dendritic proximity between principal and granule cell dendrites<a class="headerlink" href="#reciprocal-synapses-were-formed-based-on-dendritic-proximity-between-principal-and-granule-cell-dendrites" title="Permalink to this headline">¶</a></h2>
<p>After all the cell dendrites were in their appropriate locations, reciprocal synapses were formed between mitral and granule cells and tufted and granule cells. Synapses were formed where granule cell dendrites approached mitral or tufted cell dendrites within 5 microns. At each location, an excitatory AMPA/MNDA synapse was placed onto the granule cell membrane, and an inhibitory GABA synapse was placed onto the tufted/mitral cell membrane. Granule cells that did not form any synapses were removed from the simulation. The synapse information was saved for later instantiation in NEURON and can be seen under <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/tree/master/olfactorybulb/slices/DorsalColumnSlice">[repo]/slices/DorsalColumnSlice (GCs__MCs.json and GCs__TCs.json files)</a>.</p>
</div>
<div class="section" id="gap-junctions-were-formed-between-glomerular-sibling-principal-cell-tufted-dendrites">
<h2>Gap junctions were formed between glomerular sibling principal cell tufted dendrites<a class="headerlink" href="#gap-junctions-were-formed-between-glomerular-sibling-principal-cell-tufted-dendrites" title="Permalink to this headline">¶</a></h2>
<p>Gap junctions were added between the apical tufts of glomerular sibling mitral cells. The same was done with glomerular sibling tufted cells. NEURON <code class="docutils literal notranslate"><span class="pre">.setup_transfer()</span></code> function was used to share the continuous current flows between the connected principal compartments. Within a glomerulus, the sibling pricipal cells were connected with each other in a round-robin fashion, where each pricipal cell was connected by gap junctions to two other siblings of same cell type. This procedure can be seen in <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/blob/master/olfactorybulb/model.py#L333">model.py add_gap_junctions()</a>.</p>
</div>
<div class="section" id="glomeruli-stimulated-during-odor-experiments-were-mapped-onto-the-model-glomeruli">
<h2>Glomeruli stimulated during odor experiments were mapped onto the model glomeruli<a class="headerlink" href="#glomeruli-stimulated-during-odor-experiments-were-mapped-onto-the-model-glomeruli" title="Permalink to this headline">¶</a></h2>
<p>To stimulate glomeruli with realistic activation patterns, glomerular activations visible in optical glomerular imaging experiments done in Vincis et. al. (2012) were used to stimulate the network. These activations were previously digitized in Migliore et. al. (2014) model. To identify the analogous glomeruli, the Migliore model was imported into Blender using BlenderNEURON and the model’s glomeruli were registered with the reconstructed glomerular layer of this model. The glomerular locations that were closest to those in the Migliore model were used for odor input. The odors from Vincis and the corresponding glomeruli and their peak intensities were stored in the SQLite database in <code class="docutils literal notranslate"><span class="pre">odor</span></code> and <code class="docutils literal notranslate"><span class="pre">odor_glom</span></code> tables.</p>
</div>
<div class="section" id="a-model-of-glomerular-input-spikes-was-created-to-stimulate-the-model">
<h2>A model of glomerular input spikes was created to stimulate the model<a class="headerlink" href="#a-model-of-glomerular-input-spikes-was-created-to-stimulate-the-model" title="Permalink to this headline">¶</a></h2>
<p>Each tufted dendrite of a pricipal cell received input stimulation in the form of a train of spikes. The spike times for each cell were picked from a Gaussian distribution whose symmetric 99% range was scaled to correspond to the chosen inhalation duration (e.g. 100 ms). The spikes were delivered to excitatory synapses placed in each pricipal cell’s apical dendrites. This procedure can be seen in <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/blob/master/olfactorybulb/model.py#L134">model.py stim_glom_segments()</a></p>
</div>
<div class="section" id="an-extracellular-local-field-potential-electrode-was-placed-into-the-granule-cell-layer">
<h2>An extracellular local field potential electrode was placed into the granule cell layer<a class="headerlink" href="#an-extracellular-local-field-potential-electrode-was-placed-into-the-granule-cell-layer" title="Permalink to this headline">¶</a></h2>
<p>Earlier work by Parasuram et. al. (2016) was extended to create a Python-based, MPI-compatible version of LFPsim. The new version, <a class="reference external" href="https://github.com/JustasB/LFPsimpy">LFPsimpy</a> was utilized in this model. Using the library an extracellular electrode was placed in approximately the same location in the granule cell layer as in Manabe &amp; Mori (2013) which demonstrated the gamma fingerprint. The code to insert the electrode can be seen in <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/blob/master/olfactorybulb/model.py#L134">model.py create_lfp_electrode()</a></p>
</div>
<div class="section" id="neuron-mpi-simulations-were-performed-and-lfp-signal-analyzed-using-wavelet-transform">
<h2>NEURON+MPI simulations were performed and LFP signal analyzed using wavelet transform<a class="headerlink" href="#neuron-mpi-simulations-were-performed-and-lfp-signal-analyzed-using-wavelet-transform" title="Permalink to this headline">¶</a></h2>
<p>The model was designed to utilize multiple processes using MPI and Parallel NEURON. During model initializtion, cells were distributed by placing them onto least utilized ranks. The number of cell compartments (segments) was used a proxy for cell complexity. Simulations were performed on Arizona State University computers and on Amazon Web Services instances. Most simulations were 1,800 ms long. The full model initialization and simulation code can be seen in <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/blob/master/olfactorybulb/model.py#L30">model.py OlfactoryBulb class</a></p>
<p>During simulations, input spike times, soma membrane voltages of pricipal cells, and the LFP electrode signal were collected and saved at the end of the simulation for off-line analysis. The LFP signal was first band-pass filtered to 30-120 Hz, and then the <a class="reference external" href="https://github.com/PyWavelets/pywt">pywavelets</a> package was used to create wavelet spectrogram of the filtered signal. The final spectrogam was the average spectrogram of all sniffs during the simulation. The <a class="reference external" href="https://github.com/JustasB/OlfactoryBulb/blob/master/notebooks/LFP%20Wavelet%20Analysis.ipynb">LFP Wavelet Analysis.ipynb</a> notebook contains the wavelet decomposition code.</p>
</div>
<div class="section" id="network-parameters-were-explored-until-the-two-cluster-gamma-fingerprint-was-reproduced">
<h2>Network parameters were explored until the two-cluster gamma fingerprint was reproduced<a class="headerlink" href="#network-parameters-were-explored-until-the-two-cluster-gamma-fingerprint-was-reproduced" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="computational-experiments-were-performed-to-demonstrate-the-mechanisms-underlying-the-gamma-fingerprint">
<h2>Computational experiments were performed to demonstrate the mechanisms underlying the gamma fingerprint<a class="headerlink" href="#computational-experiments-were-performed-to-demonstrate-the-mechanisms-underlying-the-gamma-fingerprint" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>experiments</dt><dd><ul>
<li><p>silent network</p></li>
<li><p>Only MCs or TCs</p></li>
<li><p>Added GCs</p></li>
<li><p>Added Gap Junctions</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cloud.html" class="btn btn-neutral float-right" title="Running Simulations in the Cloud (AWS)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="visualizing.html" class="btn btn-neutral float-left" title="Visualizing the Model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Justas Birgiolas

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>